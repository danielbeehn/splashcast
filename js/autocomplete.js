function addressAutocomplete(containerElement,callback,options){const MIN_ADDRESS_LENGTH=3;const DEBOUNCE_DELAY=300;const inputContainerElement=document.createElement("form");inputContainerElement.setAttribute("class","input-container");inputContainerElement.setAttribute("name","usr-loc");containerElement.appendChild(inputContainerElement);const inputElement=document.createElement("input");inputElement.setAttribute("type","text");inputElement.setAttribute("placeholder",options.placeholder);inputContainerElement.appendChild(inputElement);const submitButton=document.createElement("button");submitButton.setAttribute("type","subnmit");submitButton.setAttribute("id","submit-btn");const buttonIcon="<i class='fas fa-arrow-alt-circle-right'></i>";submitButton.innerHTML=buttonIcon;submitButton.addEventListener("click",(e)=>{});inputContainerElement.appendChild(submitButton);let currentTimeout;let currentPromiseReject;let focusedItemIndex;inputElement.addEventListener("input",function(e){const currentValue=this.value;closeDropDownList();if(currentTimeout){clearTimeout(currentTimeout)}if(currentPromiseReject){currentPromiseReject({canceled:true})}if(!currentValue){submitButton.classList.remove("visible")}submitButton.classList.add("visible");if(!currentValue||currentValue.length<MIN_ADDRESS_LENGTH){return false}currentTimeout=setTimeout(()=>{currentTimeout=null;const promise=new Promise((resolve,reject)=>{currentPromiseReject=reject;const apiKey="474604af898543eca1f248c0dc0c3536";var url=`https://api.geoapify.com/v1/geocode/autocomplete?text=${encodeURIComponent(currentValue)}&type=city&format=json&limit=5&apiKey=${ apiKey }`;fetch(url).then(response=>{currentPromiseReject=null;if(response.ok){response.json().then(data=>resolve(data))}else{response.json().then(data=>reject(data))}})});promise.then((data)=>{currentItems=data.results;console.log(currentItems);const autocompleteItemsElement=document.createElement("div");autocompleteItemsElement.setAttribute("class","autocomplete-items");if(currentItems.length>0){inputContainerElement.appendChild(autocompleteItemsElement)}data.results.forEach((result,index)=>{const itemElement=document.createElement("div");itemElement.innerHTML=result.formatted;autocompleteItemsElement.appendChild(itemElement);itemElement.addEventListener("click",function(e){inputElement.value=currentItems[index].formatted;callback(currentItems[index]);closeDropDownList()})})},(err)=>{if(!err.canceled){console.log(err)}})},DEBOUNCE_DELAY)});inputElement.addEventListener("keydown",function(e){var autocompleteItemsElement=containerElement.querySelector(".autocomplete-items");if(autocompleteItemsElement){var itemElements=autocompleteItemsElement.getElementsByTagName("div");if(e.keyCode==40){e.preventDefault();focusedItemIndex=focusedItemIndex!==itemElements.length-1?focusedItemIndex+1:0;setActive(itemElements,focusedItemIndex)}else if(e.keyCode==38){e.preventDefault();focusedItemIndex=focusedItemIndex!==0?focusedItemIndex-1:focusedItemIndex=(itemElements.length-1);setActive(itemElements,focusedItemIndex)}else if(e.keyCode==13){e.preventDefault();if(focusedItemIndex>-1){closeDropDownList()}}}else{if(e.keyCode==40){var event=document.createEvent('Event');event.initEvent('input',true,true);inputElement.dispatchEvent(event)}}});function setActive(items,index){if(!items||!items.length){return false}for(var i=0;i<items.length;i+=1){items[i].classList.remove("autocomplete-active")}items[index].classList.add("autocomplete-active");inputElement.value=currentItems[index].formatted;callback(currentItems[index])}function closeDropDownList(){const autocompleteItemsElement=inputContainerElement.querySelector(".autocomplete-items");if(autocompleteItemsElement){inputContainerElement.removeChild(autocompleteItemsElement)}focusedItemIndex=-1}document.addEventListener("click",function(e){if(e.target!==inputElement){closeDropDownList()}else if(!containerElement.querySelector(".autocomplete-items")){var event=document.createEvent('Event');event.initEvent('input',true,true);inputElement.dispatchEvent(event)}})}addressAutocomplete(document.getElementById("autocomplete-container"),(data)=>{console.log("Selected option: ");console.log(data)},{placeholder:"Search for your location..."});