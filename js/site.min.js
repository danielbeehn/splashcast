document.querySelector("#error").style.display="none";let image="",forecast="";const menu=document.querySelector("#menu"),menuContent=document.querySelector("#menu-content"),menuCloseBtn=document.querySelector("#menu-close-btn"),currentLoc=document.querySelector("#current-loc"),changeLoc=document.querySelector("#change-loc"),useMetric=document.querySelector("#use-metric"),useHD=document.querySelector("#use-hd"),forecastScrn=document.querySelector("#forecast"),menuToggle=document.querySelector("#menu-toggle"),alerts=document.querySelector("#alerts"),alertCloseBtn=document.querySelector("#alert-close-btn"),alertContent=document.querySelector("#alert-content p"),forecastIcon=document.querySelector("#forecast-icon"),mainHeading=document.querySelector("#main-heading span"),feelsLike=document.querySelector("#feelslike span"),wind=document.querySelector("#wind span"),precip=document.querySelector("#precip span"),pressure=document.querySelector("#pressure span"),highTemp=document.querySelector("#high span"),lowTemp=document.querySelector("#low span"),imgCredits=document.querySelector("#img-credits"),bgImage=document.querySelector("#background"),intro=document.querySelector("#intro"),errorMsg=document.querySelector("#error"),usrLoc=document.querySelector("#usr-loc"),locSubmit=document.querySelector("#loc-submit"),introForm=document.querySelector("#intro form");async function fetchData(url){const response=await fetch(url),data=await response.json();return data}function loadContent(loc){Promise.all([fetchData("https://api.unsplash.com/photos/random/?query=nature&client_id=5DjUVQVPU9Qadwxu-t_7gVGyCRmRLk1rpKyntGLux5I"),fetchData("https://api.weatherapi.com/v1/forecast.json?key=f1263c7d49ab471fb6500307202805&q="+loc+"&days=1")]).then(data=>{image={imgSD:data[0].urls.regular,imgHD:data[0].urls.full,imgAuthor:data[0].user.name,imgLink:data[0].links.html,authorLink:data[0].user.username,downloadLink:data[0].user.download_location},forecast={currentF:Math.round(parseInt(data[1].current.temp_f)),currentC:Math.round(parseInt(data[1].current.temp_c)),highF:Math.round(parseInt(data[1].forecast.forecastday[0].day.maxtemp_f)),highC:Math.round(parseInt(data[1].forecast.forecastday[0].day.maxtemp_c)),lowF:Math.round(parseInt(data[1].forecast.forecastday[0].day.mintemp_f)),lowC:Math.round(parseInt(data[1].forecast.forecastday[0].day.mintemp_c)),feelsF:Math.round(parseInt(data[1].current.feelslike_f)),feelsC:Math.round(parseInt(data[1].current.feelslike_c)),precipIn:`${data[1].current.precip_in} in.`,precipMm:`${data[1].current.precip_mm} mm`,windMPH:`${Math.round(parseInt(data[1].current.wind_mph))} MPH`,windKPH:`${Math.round(parseInt(data[1].current.wind_kph))} kph`,windDir:data[1].current.wind_dir,pressureIn:`${data[1].current.pressure_in} in.`,pressureMb:`${data[1].current.pressure_mb} mB`,wxIcon:`https:${data[1].current.condition.icon}`,curLocation:`${data[1].location.name}, ${data[1].location.region}`,alertHeadline:data[1].alert.headline},displayContent()}).catch(error=>{localStorage.removeItem("location"),introForm.className="hide-elem",errorMsg.style.display="inherit",intro.className="show-elem",errorMsg.innerHTML=`There was an error fetching the content. Please try again later.<br>${error}`})}function displayContent(){fetchData(image.downloadLink),forecastIcon.src=forecast.wxIcon,currentLoc.textContent=forecast.curLocation,imgCredits.innerHTML=`<p><a href="http://www.unsplash.com/@${image.authorLink}">${image.imgAuthor}</a> on <a href="${image.imgLink}">Unsplash</a></p>`,"sd"===localStorage.quality||void 0===localStorage.quality?bgImage.style.backgroundImage=`url(${image.imgSD})`:bgImage.style.backgroundImage=`url(${image.imgHD})`,void 0!==forecast.alertHeadline?(alertContent.textContent=forecast.alertHeadline,setTimeout((function(){alerts.className="alert-show"}),5e3)):alerts.style.visibility="collapse","f"===localStorage.units||void 0===localStorage.units?(mainHeading.textContent=forecast.currentF,feelsLike.textContent=`${forecast.feelsF}°`,wind.textContent=`${forecast.windMPH} ${forecast.windDir}`,precip.textContent=forecast.precipIn,pressure.textContent=forecast.pressureIn,highTemp.textContent=`${forecast.highF}°`,lowTemp.textContent=`${forecast.lowF}°`):(mainHeading.textContent=forecast.currentC,feelsLike.textContent=`${forecast.feelsC}°`,wind.textContent=`${forecast.windKPH} ${forecast.windDir}`,precip.textContent=forecast.precipMm,pressure.textContent=forecast.pressureMb,highTemp.textContent=`${forecast.highC}°`,lowTemp.textContent=`${forecast.lowC}°`),bgImage.className="show-elem",forecastScrn.className="show-elem"}document.addEventListener("DOMContentLoaded",(function(){void 0!==localStorage.location?(intro.className="hide-elem",loadContent(localStorage.location)):introForm.className="show-elem"})),locSubmit.addEventListener("click",(function(e){e.preventDefault();const location=usrLoc.value;""===location?(introForm.style.borderColor="#cc0000",introForm.value="",usrLoc.setAttribute("placeholder","Please enter a location.")):(introForm.style.borderColor="#222",intro.className="hide-elem",localStorage.location=location,loadContent(location))})),menuToggle.addEventListener("click",(function(){menu.className="menu-show"})),alertCloseBtn.addEventListener("click",(function(){alerts.className="alert-hide",alerts.style.visibility="collapse"})),menuCloseBtn.addEventListener("click",(function(){menu.className="menu-hide"})),useMetric.addEventListener("click",(function(){useMetric.checked?localStorage.units="c":localStorage.units="f",displayContent()})),useHD.addEventListener("click",(function(){useHD.checked?localStorage.quality="hd":localStorage.quality="sd",displayContent()})),changeLoc.addEventListener("click",(function(e){e.preventDefault(),menu.className="menu-hide",forecastScrn.className="hide-elem",bgImage.className="hide-elem",alerts.className="alert-hide",intro.className="show-elem",introForm.className="show-elem"}));